function rendermap(n){if(n&&n!==null){mapboxgl.accessToken=document.getElementById("mapboxtoken").value;const t=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[n.coords.longitude,n.coords.latitude],zoom:7}),i=new mapboxgl.NavigationControl;t.addControl(i,"bottom-right");t.on("load",()=>{mapcallback(t)})}}function mapcallback(n){n.addSource("sceneries",{type:"geojson",data:`${apiRoot}/sceneries`,cluster:!0,clusterRadius:50,clusterMaxZoom:6});n.addLayer({id:"sceneries",type:"circle",source:"sceneries",filter:["!has","point_count"],paint:{"circle-color":"#a890f0","circle-radius":5,"circle-stroke-width":1,"circle-stroke-color":"#fff"}});n.on("mouseenter","sceneries",t=>{n.getCanvas().style.cursor="pointer";const i=t.features[0].properties.name;$("#card").modal("toggle");const r=`/api/g/r/${i}`;fetch(r).then(n=>n.status===200?n.json():{}).then(n=>{setSceneryProperties(n)}).catch(n=>{console.log(n),document.getElementById("scenery-image").src="https://via.placeholder.com/400x200?text=Error+while+loading+data"})});n.on("mouseleave","sceneries",()=>{n.getCanvas().style.cursor="",closeInfoCard()});var t=places({container:document.querySelector("#where-to-go"),type:"city"});t.on("change",t=>{n.flyTo({center:[t.suggestion.latlng.lng,t.suggestion.latlng.lat],zoom:9})})}function setSceneryProperties(n){n&&n!==null&&(document.getElementById("scenery-image").src=n.photo&&n.photo!==null?`data:image/png;base64,${n.photo}`:"https://via.placeholder.com/500x300?text=No+Image+Found",document.getElementById("name").innerText=n.name||"",document.getElementById("address").innerText=n.formattedAddress||"",document.getElementById("website").innerHTML=n.website||"")}function closeInfoCard(){document.getElementById("scenery-image").src="https://via.placeholder.com/500x300?text=loading";document.getElementById("name").innerText="";document.getElementById("address").innerText="";document.getElementById("website").innerHTML="";$("#card").modal("toggle")}function getBaseUri(n=false){const t=window.location,i=t.protocol,r=t.host;return n?`${i}//${r}/api`:`${i}//${r}`}let lang="";const apiRoot=getBaseUri(!0);(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(rendermap)})();